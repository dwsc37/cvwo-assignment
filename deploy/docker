docker stop cvwoassignment-server-container
docker remove cvwoassignment-server-container

docker stop cvwoassignment-client-container
docker remove cvwoassignment-client-container

docker build -t cvwoassignment-client:latest ./client
docker build -t cvwoassignment-server:latest ./server

docker network create nginx_network

docker run --network="nginx_network" --name cvwoassignment-server-container -p 8080:8080 -d -e PORT=':8080' -e DB='host=john.db.elephantsql.com user=rqtzvtmi password=uO8yRPJ1XNEnV7z5Tc20qHWqx1-NsrpU dbname=rqtzvtmi port=5432 sslmode=disable' -e CLIENT='http://localhost:80' -e SECRET='asdfjaklsejkc12343u2ad' cvwoassignment-server:latest
docker run --network="nginx_network" --name cvwoassignment-client-container -p 80:80 -d cvwoassignment-client:latest

docker save -o cvwoassignment-client.tar cvwoassignment-client:latest
docker save -o cvwoassignment-server.tar cvwoassignment-server:latest

scp -i ./cvwoassignment.pem *.tar ec2-user@ec2-54-255-234-127.ap-southeast-1.compute.amazonaws.com:/home/ec2-user/cvwo

docker load -i cvwoassignment-client.tar
docker load -i cvwoassignment-server.tar

docker run --network="nginx_network" --name cvwoassignment-server-container -p 8080:8080 -d -e PORT=':8080' -e DB='host=john.db.elephantsql.com user=rqtzvtmi password=uO8yRPJ1XNEnV7z5Tc20qHWqx1-NsrpU dbname=rqtzvtmi port=5432 sslmode=disable' -e CLIENT='http://localhost:80' -e SECRET='asdfjaklsejkc12343u2ad' cvwoassignment-server:latest
docker run --network="nginx_network" --name cvwoassignment-client-container -p 80:80 -d cvwoassignment-client:latest











////////////////////////////////////


aws ecr get-login-password --region ap-southeast-1 | docker login --username AWS --password-stdin 533267330023.dkr.ecr.ap-southeast-1.amazonaws.com

docker tag cvwoassignment:client-latest 533267330023.dkr.ecr.ap-southeast-1.amazonaws.com/cvwoassignment:client-latest
docker tag cvwoassignment:server-latest 533267330023.dkr.ecr.ap-southeast-1.amazonaws.com/cvwoassignment:server-latest

docker push 533267330023.dkr.ecr.ap-southeast-1.amazonaws.com/cvwoassignment:client-latest
docker push 533267330023.dkr.ecr.ap-southeast-1.amazonaws.com/cvwoassignment:server-latest

